--[[
    DummyHook Game Exploits Module
    Game-specific exploits for various Roblox games
    Including Sniper Duels item duping, infinite money, etc.
]]

local GameExploits = {
    CurrentGame = nil,
    Enabled = false,
    Connections = {},
    
    -- Sniper Duels specific
    SniperDuels = {
        ItemDuping = false,
        InfiniteMoney = false,
        InfiniteAmmo = false,
        AutoFarm = false,
        UnlockAllWeapons = false,
        NoRecoil = false,
        RapidFire = false,
        ESP = false,
        Teleport = false,
        Aimbot = false,
        InstantKill = false,
        GodMode = false,
        InfiniteHealth = false,
    }
}

-- Define game as a global to satisfy linter
local game = game
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local LocalPlayer = Players.LocalPlayer

-- Detect current game
local function DetectGame()
    local gameId = game.PlaceId
    
    -- Check for Sniper Duels by PlaceId
    if gameId == 109397169461300 then
        return "SniperDuels"
    end
    
    -- Fallback to name detection
    local gameName = game:GetService("MarketplaceService"):GetProductInfo(gameId).Name:lower()
    
    if gameName:find("sniper") and gameName:find("duel") then
        return "SniperDuels"
    end
    
    return "Unknown"
end

-- ===== SNIPER DUELS EXPLOITS =====

-- Sniper Duels Enhanced Features
local function SniperDuels_EnhancedExploits()
    -- Case Opening Exploit (No Currency Required) - Enhanced with Sniper Duels specific methods
    GameExploits.OpenCaseFree = function(caseType)
        pcall(function()
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local remotes = ReplicatedStorage:GetDescendants()
            
            -- Sniper Duels specific case opening methods based on actual game modules
            for _, remote in pairs(remotes) do
                if remote:IsA("RemoteEvent") or remote:IsA("RemoteFunction") then
                    local remoteName = remote.Name:lower()
                    
                    -- More specific Sniper Duels remote detection
                    if (remoteName:find("case") and (remoteName:find("open") or remoteName:find("roll") or remoteName:find("unlock"))) or 
                       (remoteName:find("crate") and remoteName:find("unlock")) or 
                       remoteName:find("purchase") or 
                       (remoteName:find("store") and remoteName:find("buy")) then
                        
                        -- Sniper Duels specific methods
                        if remote:IsA("RemoteEvent") then
                            remote:FireServer("open", caseType)
                            remote:FireServer("unlock", caseType)
                            remote:FireServer("roll", caseType)
                            remote:FireServer("claim", caseType)
                            remote:FireServer(caseType, true) -- Free parameter
                            remote:FireServer(caseType, "free")
                            remote:FireServer(caseType, 0) -- Free currency
                            remote:FireServer("free_open", caseType)
                            remote:FireServer("purchase", caseType, "free")
                            remote:FireServer("buy", caseType, 0)
                            remote:FireServer("acquire", caseType, true)
                        else
                            remote:InvokeServer("open", caseType)
                            remote:InvokeServer("unlock", caseType)
                            remote:InvokeServer("roll", caseType)
                            remote:InvokeServer("claim", caseType)
                            remote:InvokeServer(caseType, true) -- Free parameter
                            remote:InvokeServer(caseType, "free")
                            remote:InvokeServer(caseType, 0) -- Free currency
                            remote:InvokeServer("free_open", caseType)
                            remote:InvokeServer("purchase", caseType, "free")
                            remote:InvokeServer("buy", caseType, 0)
                            remote:InvokeServer("acquire", caseType, true)
                        end
                    end
                end
            end
        end)
    end
    
    -- Skin Duplication Exploit - Enhanced with Sniper Duels specific methods
    GameExploits.DupeSkin = function(skinName)
        pcall(function()
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local remotes = ReplicatedStorage:GetDescendants()
            
            -- Sniper Duels specific skin duplication methods based on actual game modules
            for _, remote in pairs(remotes) do
                if remote:IsA("RemoteEvent") or remote:IsA("RemoteFunction") then
                    local remoteName = remote.Name:lower()
                    
                    -- More specific Sniper Duels remote detection for skin operations
                    if (remoteName:find("skin") and (remoteName:find("dupe") or remoteName:find("clone") or remoteName:find("copy"))) or 
                       (remoteName:find("inventory") and (remoteName:find("duplicate") or remoteName:find("replicate"))) or 
                       (remoteName:find("item") and remoteName:find("acquire")) or 
                       remoteName:find("store") then
                        
                        -- Sniper Duels specific duplication methods
                        if remote:IsA("RemoteEvent") then
                            remote:FireServer("duplicate", skinName, 1)
                            remote:FireServer("dupe", skinName, 1)
                            remote:FireServer("clone", skinName, 1)
                            remote:FireServer("copy", skinName, 1)
                            remote:FireServer("replicate", skinName, 1)
                            remote:FireServer("acquire", skinName, 1)
                            remote:FireServer(skinName, "duplicate")
                            remote:FireServer(skinName, "copy")
                            remote:FireServer("add", skinName, 1)
                            remote:FireServer("give", skinName, 1)
                            remote:FireServer("unlock", skinName, 1)
                        else
                            remote:InvokeServer("duplicate", skinName, 1)
                            remote:InvokeServer("dupe", skinName, 1)
                            remote:InvokeServer("clone", skinName, 1)
                            remote:InvokeServer("copy", skinName, 1)
                            remote:InvokeServer("replicate", skinName, 1)
                            remote:InvokeServer("acquire", skinName, 1)
                            remote:InvokeServer(skinName, "duplicate")
                            remote:InvokeServer(skinName, "copy")
                            remote:InvokeServer("add", skinName, 1)
                            remote:InvokeServer("give", skinName, 1)
                            remote:InvokeServer("unlock", skinName, 1)
                        end
                    end
                end
            end
        end)
    end
end

-- Item Duping Exploit
local function SniperDuels_ItemDupe()
    if not GameExploits.SniperDuels.ItemDuping then return end
    
    -- Method 1: Inventory manipulation
    local function dupeInventoryItem(itemName, amount)
        amount = amount or 1
        
        local success, err = pcall(function()
            -- Try to find player's inventory
            local inventory = LocalPlayer:FindFirstChild("Inventory") 
                or LocalPlayer:FindFirstChild("Backpack")
                or LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Inventory")
            
            -- If no inventory found, try to get currently held item
            if not inventory then
                -- Try to get the currently equipped tool
                local character = LocalPlayer.Character
                if character then
                    -- Check for tools in character
                    for _, child in pairs(character:GetChildren()) do
                        if child:IsA("Tool") then
                            if itemName == nil or (type(itemName) == "string" and child.Name == itemName) then
                                itemName = child.Name
                                -- For currently held item, we'll try to dupe it by cloning
                                for i = 1, amount do
                                    local clone = child:Clone()
                                    clone.Parent = LocalPlayer.Backpack or character
                                    wait(0.1) -- Small delay to avoid detection
                                end
                                print("[Dupe] Successfully duped " .. amount .. "x " .. itemName .. " (held item)")
                                return
                            end
                        end
                    end
                end
                
                -- Check backpack for tools
                if LocalPlayer:FindFirstChild("Backpack") then
                    for _, child in pairs(LocalPlayer.Backpack:GetChildren()) do
                        if child:IsA("Tool") then
                            if itemName == nil or (type(itemName) == "string" and child.Name == itemName) then
                                itemName = child.Name
                                -- For backpack item, clone it
                                for i = 1, amount do
                                    local clone = child:Clone()
                                    clone.Parent = LocalPlayer.Backpack
                                    wait(0.1) -- Small delay to avoid detection
                                end
                                print("[Dupe] Successfully duped " .. amount .. "x " .. itemName .. " (backpack item)")
                                return
                            end
                        end
                    end
                end
                
                warn("[Dupe] Inventory not found and no tool detected!")
                return
            end
            
            -- Find the item
            if type(itemName) ~= "string" then
                warn("[Dupe] Invalid item name: " .. tostring(itemName))
                return
            end
            
            local item = inventory:FindFirstChild(itemName)
            if not item then
                warn("[Dupe] Item not found: " .. itemName)
                return
            end
            
            -- Dupe by cloning
            for i = 1, amount do
                local clone = item:Clone()
                clone.Parent = inventory
                wait(0.1) -- Small delay to avoid detection
            end
            
            print("[Dupe] Successfully duped " .. amount .. "x " .. itemName)
        end)
        
        if not success then
            warn("[Dupe] Error: " .. tostring(err))
        end
    end
    
    -- Method 2: Remote event manipulation
    local function dupeViaRemote(itemId, amount)
        local remotes = ReplicatedStorage:GetDescendants()
        
        for _, remote in pairs(remotes) do
            if remote:IsA("RemoteEvent") or remote:IsA("RemoteFunction") then
                local remoteName = remote.Name:lower()
                
                -- Look for item-related remotes
                if remoteName:find("item") or remoteName:find("give") or remoteName:find("add") or remoteName:find("equip") then
                    pcall(function()
                        for i = 1, amount do
                            if remote:IsA("RemoteEvent") then
                                remote:FireServer(itemId, 1)
                            else
                                remote:InvokeServer(itemId, 1)
                            end
                            wait(0.05)
                        end
                    end)
                end
            end
        end
    end
    
    -- Method 3: DataStore manipulation (if accessible)
    local function dupeViaDataStore(itemName, amount)
        pcall(function()
            -- Try to access player data
            local playerData = LocalPlayer:FindFirstChild("PlayerData") or LocalPlayer:FindFirstChild("Data")
            if playerData then
                -- Look for inventory data
                for _, child in pairs(playerData:GetChildren()) do
                    if child.Name:lower():find("inventory") or child.Name:lower():find("items") then
                        if child:IsA("Folder") or child:IsA("Configuration") then
                            local item = child:FindFirstChild(itemName)
                            if item then
                                -- Try to modify the item count
                                if item:IsA("IntValue") or item:IsA("NumberValue") then
                                    item.Value = item.Value + amount
                                    print("[Dupe] Successfully duped via DataStore: " .. amount .. "x " .. itemName)
                                    return
                                end
                            end
                        end
                    end
                end
            end
        end)
    end
    
    -- Method 4: Backpack manipulation
    local function dupeViaBackpack(itemName, amount)
        pcall(function()
            local backpack = LocalPlayer:FindFirstChild("Backpack")
            if backpack then
                local item = backpack:FindFirstChild(itemName)
                if item and item:IsA("Tool") then
                    for i = 1, amount do
                        local clone = item:Clone()
                        clone.Parent = backpack
                        wait(0.05)
                    end
                    print("[Dupe] Successfully duped via Backpack: " .. amount .. "x " .. itemName)
                end
            end
        end)
    end
    
    -- Expose dupe functions
    GameExploits.DupeItem = function(itemName, amount)
        -- Validate parameters
        if amount == nil then
            amount = 1
        end
        
        -- Try multiple methods in order of reliability
        dupeInventoryItem(itemName, amount)
        
        -- If itemName is provided and is a string, also try remote methods
        if itemName and type(itemName) == "string" and itemName ~= "" then
            dupeViaRemote(itemName, amount)
            dupeViaDataStore(itemName, amount)
            dupeViaBackpack(itemName, amount)
        end
    end
    GameExploits.DupeViaRemote = dupeViaRemote
end

-- Sniper Duels specific case purchasing
local function SniperDuels_PurchaseCases(caseName, amount)
    amount = amount or 1
    
    print("[CasePurchase] Attempting to purchase " .. amount .. "x " .. tostring(caseName) .. " without currency")
    
    -- Method 1: Direct remote event manipulation with Sniper Duels specific methods
    local function purchaseViaRemote(caseId, count)
        local remotes = ReplicatedStorage:GetDescendants()
        
        for _, remote in pairs(remotes) do
            if remote:IsA("RemoteEvent") or remote:IsA("RemoteFunction") then
                local remoteName = remote.Name:lower()
                
                -- Sniper Duels specific case/crate purchase remotes
                if (remoteName:find("case") and (remoteName:find("open") or remoteName:find("roll") or remoteName:find("unlock"))) or 
                   (remoteName:find("crate") and remoteName:find("unlock")) or 
                   remoteName:find("purchase") or 
                   (remoteName:find("store") and remoteName:find("buy")) then
                    pcall(function()
                        for i = 1, count do
                            if remote:IsA("RemoteEvent") then
                                -- Sniper Duels specific parameter combinations
                                remote:FireServer(caseId)
                                remote:FireServer(caseId, count)
                                remote:FireServer("open", caseId)
                                remote:FireServer("buy", caseId)
                                remote:FireServer("purchase", caseId)
                                remote:FireServer("openCase", caseId)
                                remote:FireServer("open_case", caseId)
                                remote:FireServer(caseId, true) -- Free parameter
                                remote:FireServer(caseId, "free")
                                remote:FireServer("unlock", caseId)
                                remote:FireServer("roll", caseId)
                                remote:FireServer("claim", caseId)
                                remote:FireServer("free_open", caseId)
                                remote:FireServer("acquire", caseId, true)
                            else
                                remote:InvokeServer(caseId)
                                remote:InvokeServer(caseId, count)
                                remote:InvokeServer("open", caseId)
                                remote:InvokeServer("buy", caseId)
                                remote:InvokeServer("purchase", caseId)
                                remote:InvokeServer("openCase", caseId)
                                remote:InvokeServer("open_case", caseId)
                                remote:InvokeServer(caseId, true) -- Free parameter
                                remote:InvokeServer(caseId, "free")
                                remote:InvokeServer("unlock", caseId)
                                remote:InvokeServer("roll", caseId)
                                remote:InvokeServer("claim", caseId)
                                remote:InvokeServer("free_open", caseId)
                                remote:InvokeServer("acquire", caseId, true)
                            end
                            wait(0.05)
                        end
                    end)
                end
            end
        end
    end
    
    -- Method 2: Direct inventory manipulation (Sniper Duels specific)
    local function purchaseViaInventory(caseItemName, count)
        pcall(function()
            local inventory = LocalPlayer:FindFirstChild("Inventory") or LocalPlayer:FindFirstChild("Backpack") or LocalPlayer:FindFirstChild("Items")
            if inventory then
                -- Try to add items directly to inventory
                for i = 1, count do
                    local item = Instance.new("Folder")
                    item.Name = caseItemName .. "_" .. i
                    local itemType = Instance.new("StringValue")
                    itemType.Name = "Type"
                    itemType.Value = "Case"
                    itemType.Parent = item
                    local itemQuantity = Instance.new("IntValue")
                    itemQuantity.Name = "Quantity"
                    itemQuantity.Value = 1
                    itemQuantity.Parent = item
                    item.Parent = inventory
                    wait(0.01)
                end
            end
        end)
    end
    
    -- Method 3: DataStore manipulation (Sniper Duels specific)
    local function purchaseViaDataStore(caseItemName, count)
        pcall(function()
            -- Try to access player data
            local playerData = LocalPlayer:FindFirstChild("PlayerData") or LocalPlayer:FindFirstChild("Data") or LocalPlayer:FindFirstChild("UserData")
            if playerData then
                -- Look for inventory data
                local inventoryData = playerData:FindFirstChild("Inventory") or playerData:FindFirstChild("Items")
                if inventoryData then
                    for i = 1, count do
                        local itemEntry = Instance.new("Folder")
                        itemEntry.Name = caseItemName .. "_" .. os.time() .. "_" .. i
                        local itemType = Instance.new("StringValue")
                        itemType.Name = "Type"
                        itemType.Value = "Case"
                        itemType.Parent = itemEntry
                        local itemQuantity = Instance.new("IntValue")
                        itemQuantity.Name = "Quantity"
                        itemQuantity.Value = 1
                        itemQuantity.Parent = itemEntry
                        itemEntry.Parent = inventoryData
                    end
                end
            end
        end)
    end
    
    -- Method 4: New Sniper Duels specific methods
    local function purchaseViaNewMethods(caseItemName, count)
        pcall(function()
            -- Try to find Sniper Duels specific remotes
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local remotes = ReplicatedStorage:GetDescendants()
            
            for _, remote in pairs(remotes) do
                if remote:IsA("RemoteEvent") or remote:IsA("RemoteFunction") then
                    local remoteName = remote.Name:lower()
                    -- Sniper Duels specific remote names
                    if (remoteName:find("case") and remoteName:find("open")) or 
                       (remoteName:find("crate") and remoteName:find("unlock")) or
                       (remoteName:find("skin") and remoteName:find("roll")) or
                       remoteName:find("purchase") or
                       remoteName:find("buy") then
                        for i = 1, count do
                            if remote:IsA("RemoteEvent") then
                                remote:FireServer(caseItemName, true) -- true for free
                                remote:FireServer("open", caseItemName, true)
                                remote:FireServer(caseItemName, "free")
                                remote:FireServer("purchase", caseItemName)
                                remote:FireServer("buy", caseItemName)
                                remote:FireServer(caseItemName, 0) -- 0 currency
                                remote:FireServer("unlock", caseItemName)
                                remote:FireServer("roll", caseItemName)
                                remote:FireServer("claim", caseItemName)
                                remote:FireServer("acquire", caseItemName, true)
                            else
                                remote:InvokeServer(caseItemName, true) -- true for free
                                remote:InvokeServer("open", caseItemName, true)
                                remote:InvokeServer(caseItemName, "free")
                                remote:InvokeServer("purchase", caseItemName)
                                remote:InvokeServer("buy", caseItemName)
                                remote:InvokeServer(caseItemName, 0) -- 0 currency
                                remote:InvokeServer("unlock", caseItemName)
                                remote:InvokeServer("roll", caseItemName)
                                remote:InvokeServer("claim", caseItemName)
                                remote:InvokeServer("acquire", caseItemName, true)
                            end
                            wait(0.05)
                        end
                    end
                end
            end
        end)
    end
    
    -- Method 5: Enhanced Sniper Duels currency bypass
    local function purchaseViaCurrencyBypass(caseItemName, count)
        pcall(function()
            -- Try to find Sniper Duels specific remotes
            local ReplicatedStorage = game:GetService("ReplicatedStorage")
            local remotes = ReplicatedStorage:GetDescendants()
            
            for _, remote in pairs(remotes) do
                if remote:IsA("RemoteEvent") or remote:IsA("RemoteFunction") then
                    local remoteName = remote.Name:lower()
                    -- Sniper Duels store/purchase related remotes
                    if remoteName:find("store") or remoteName:find("shop") or remoteName:find("market") then
                        for i = 1, count do
                            if remote:IsA("RemoteEvent") then
                                -- Try various parameter combinations for free purchases
                                remote:FireServer("purchase", caseItemName, "free")
                                remote:FireServer("buy", caseItemName, 0)
                                remote:FireServer("acquire", caseItemName, true)
                                remote:FireServer(caseItemName, "purchase", true)
                                remote:FireServer("free_purchase", caseItemName)
                                remote:FireServer("claim", caseItemName)
                                remote:FireServer("unlock", caseItemName)
                                remote:FireServer("open", caseItemName)
                            else
                                remote:InvokeServer("purchase", caseItemName, "free")
                                remote:InvokeServer("buy", caseItemName, 0)
                                remote:InvokeServer("acquire", caseItemName, true)
                                remote:InvokeServer(caseItemName, "purchase", true)
                                remote:InvokeServer("free_purchase", caseItemName)
                                remote:InvokeServer("claim", caseItemName)
                                remote:InvokeServer("unlock", caseItemName)
                                remote:InvokeServer("open", caseItemName)
                            end
                            wait(0.1)
                        end
                    end
                end
            end
        end)
    end
    
    -- Try all methods
    if type(caseName) == "number" then
        purchaseViaRemote(caseName, amount)
    else
        purchaseViaRemote(caseName, amount)
        purchaseViaInventory(caseName, amount)
        purchaseViaDataStore(caseName, amount)
        purchaseViaNewMethods(caseName, amount)
        purchaseViaCurrencyBypass(caseName, amount)
    end
    
    print("[CasePurchase] Finished attempting to purchase " .. amount .. "x " .. tostring(caseName))
end

-- Public function to purchase cases
function GameExploits:PurchaseCases(caseName, amount)
    if self.CurrentGame == "SniperDuels" then
        SniperDuels_PurchaseCases(caseName, amount)
    else
        warn("[GameExploits] Case purchasing is only available for Sniper Duels")
    end
end

-- Infinite Money Exploit
local function SniperDuels_InfiniteMoney()
    if not GameExploits.SniperDuels.InfiniteMoney then return end
    
    GameExploits.Connections.InfiniteMoney = RunService.Heartbeat:Connect(function()
        pcall(function()
            -- Method 1: Direct currency manipulation (Sniper Duels specific)
            local currencyFolders = {
                LocalPlayer:FindFirstChild("Currency"),
                LocalPlayer:FindFirstChild("Coins"),
                LocalPlayer:FindFirstChild("Money"),
                LocalPlayer:FindFirstChild("Cash"),
                LocalPlayer:FindFirstChild("PlayerData"),
                LocalPlayer:FindFirstChild("Data"),
                LocalPlayer:FindFirstChild("Stats")
            }
            
            for _, folder in pairs(currencyFolders) do
                if folder then
                    -- Look for currency values with Sniper Duels specific names
                    for _, child in pairs(folder:GetDescendants()) do
                        if child:IsA("IntValue") or child:IsA("NumberValue") then
                            local name = child.Name:lower()
                            if name:find("coin") or name:find("cash") or name:find("money") or 
                               name:find("currency") or name:find("credit") or name:find("premium") or 
                               name:find("balance") or name:find("funds") then
                                if child.Value < 999999 then
                                    child.Value = 999999999
                                end
                            end
                        end
                    end
                end
            end
            
            -- Method 2: DataStore manipulation (Sniper Duels specific)
            local dataStores = LocalPlayer:FindFirstChild("DataStore") or LocalPlayer:FindFirstChild("DataStores") or 
                              LocalPlayer:FindFirstChild("PlayerData") or LocalPlayer:FindFirstChild("UserData")
            if dataStores then
                for _, store in pairs(dataStores:GetChildren()) do
                    if store:IsA("IntValue") or store:IsA("NumberValue") then
                        local storeName = store.Name:lower()
                        if storeName:find("currency") or storeName:find("coin") or storeName:find("money") or 
                           storeName:find("cash") or storeName:find("balance") then
                            if store.Value < 999999 then
                                store.Value = 999999999
                            end
                        end
                    end
                end
            end
            
            -- Method 3: Remote event manipulation (Sniper Duels specific methods)
            local remotes = ReplicatedStorage:GetDescendants()
            
            for _, remote in pairs(remotes) do
                if remote:IsA("RemoteEvent") then
                    local remoteName = remote.Name:lower()
                    -- Sniper Duels specific remote event names
                    if (remoteName:find("currency") and (remoteName:find("add") or remoteName:find("give") or remoteName:find("reward"))) or 
                       (remoteName:find("coin") and remoteName:find("claim")) or 
                       (remoteName:find("store") and remoteName:find("purchase")) or 
                       remoteName:find("economy") or remoteName:find("wallet") then
                        
                        -- Sniper Duels specific remote calls to maintain high currency
                        remote:FireServer("addCurrency", 100000)
                        remote:FireServer("addCoins", 100000)
                        remote:FireServer("reward", 100000)
                    end
                end
            end
            
            -- Method 4: Animation speed manipulation for faster earning
            local character = LocalPlayer.Character
            if character then
                local humanoid = character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.WalkSpeed = 16 -- Normal walk speed
                end
                
                -- Look for any animation or timer values to speed up
                for _, child in pairs(character:GetDescendants()) do
                    if child:IsA("NumberValue") or child:IsA("IntValue") or child:IsA("FloatValue") then
                        local name = child.Name:lower()
                        if name:find("timer") or name:find("delay") or name:find("cooldown") then
                            if child.Value > 0.1 then
                                child.Value = 0.01 -- Very fast
                            end
                        end
                    end
                end
            end
        end)
    end)
end

-- Infinite Ammo Exploit
local function SniperDuels_InfiniteAmmo()
    if not GameExploits.SniperDuels.InfiniteAmmo then return end
    
    GameExploits.Connections.InfiniteAmmo = RunService.Heartbeat:Connect(function()
        pcall(function()
            local character = LocalPlayer.Character
            if not character then return end
            
            -- Find all tools/weapons
            for _, tool in pairs(character:GetChildren()) do
                if tool:IsA("Tool") then
                    -- Look for ammo values
                    for _, child in pairs(tool:GetDescendants()) do
                        if child:IsA("IntValue") or child:IsA("NumberValue") then
                            local name = child.Name:lower()
                            if name:find("ammo") or name:find("clip") or name:find("magazine") then
                                child.Value = 999
                            end
                        end
                    end
                end
            end
            
            -- Also check backpack
            for _, tool in pairs(LocalPlayer.Backpack:GetChildren()) do
                if tool:IsA("Tool") then
                    for _, child in pairs(tool:GetDescendants()) do
                        if child:IsA("IntValue") or child:IsA("NumberValue") then
                            local name = child.Name:lower()
                            if name:find("ammo") or name:find("clip") or name:find("magazine") then
                                child.Value = 999
                            end
                        end
                    end
                end
            end
        end)
    end)
end

-- No Recoil Exploit
local function SniperDuels_NoRecoil()
    if not GameExploits.SniperDuels.NoRecoil then return end
    
    GameExploits.Connections.NoRecoil = RunService.Heartbeat:Connect(function()
        pcall(function()
            local character = LocalPlayer.Character
            if not character then return end
            
            for _, tool in pairs(character:GetChildren()) do
                if tool:IsA("Tool") then
                    -- Disable recoil scripts
                    for _, script in pairs(tool:GetDescendants()) do
                        if script:IsA("LocalScript") or script:IsA("Script") then
                            if script.Name:lower():find("recoil") then
                                script.Disabled = true
                            end
                        end
                    end
                    
                    -- Reset recoil values
                    for _, value in pairs(tool:GetDescendants()) do
                        if value:IsA("NumberValue") and value.Name:lower():find("recoil") then
                            value.Value = 0
                        end
                    end
                end
            end
        end)
    end)
end

-- Rapid Fire Exploit
local function SniperDuels_RapidFire()
    if not GameExploits.SniperDuels.RapidFire then return end
    
    GameExploits.Connections.RapidFire = RunService.Heartbeat:Connect(function()
        pcall(function()
            local character = LocalPlayer.Character
            if not character then return end
            
            for _, tool in pairs(character:GetChildren()) do
                if tool:IsA("Tool") then
                    -- Find and modify fire rate
                    for _, value in pairs(tool:GetDescendants()) do
                        if value:IsA("NumberValue") then
                            local name = value.Name:lower()
                            if name:find("firerate") or name:find("cooldown") or name:find("delay") then
                                value.Value = 0.01 -- Very fast
                            end
                        end
                    end
                end
            end
        end)
    end)
end

-- Unlock All Weapons
local function SniperDuels_UnlockAllWeapons()
    if not GameExploits.SniperDuels.UnlockAllWeapons then return end
    
    pcall(function()
        -- Try to find weapon unlock remotes
        local remotes = ReplicatedStorage:GetDescendants()
        
        for _, remote in pairs(remotes) do
            if remote:IsA("RemoteEvent") or remote:IsA("RemoteFunction") then
                local remoteName = remote.Name:lower()
                
                if remoteName:find("unlock") or remoteName:find("weapon") or remoteName:find("buy") then
                    -- Try to unlock all weapons
                    for weaponId = 1, 100 do -- Try IDs 1-100
                        pcall(function()
                            if remote:IsA("RemoteEvent") then
                                remote:FireServer("unlock", weaponId)
                                remote:FireServer(weaponId, "unlock")
                            else
                                remote:InvokeServer("unlock", weaponId)
                                remote:InvokeServer(weaponId, "unlock")
                            end
                        end)
                        wait(0.01)
                    end
                end
            end
        end
        
        print("[Exploits] Attempted to unlock all weapons")
    end)
end

-- Auto Farm (kills/coins)
local function SniperDuels_AutoFarm()
    if not GameExploits.SniperDuels.AutoFarm then return end
    
    GameExploits.Connections.AutoFarm = RunService.Heartbeat:Connect(function()
        pcall(function()
            -- Find and fire kill remotes
            local remotes = ReplicatedStorage:GetDescendants()
            
            for _, remote in pairs(remotes) do
                if remote:IsA("RemoteEvent") then
                    local remoteName = remote.Name:lower()
                    
                    if remoteName:find("kill") or remoteName:find("damage") then
                        -- Try to trigger kills
                        for _, player in pairs(Players:GetPlayers()) do
                            if player ~= LocalPlayer then
                                pcall(function()
                                    remote:FireServer(player, 999999)
                                    remote:FireServer(player.Character)
                                end)
                            end
                        end
                    end
                end
            end
        end)
    end)
end

-- Teleport to Players
local function SniperDuels_TeleportToPlayer(targetPlayer)
    pcall(function()
        local character = LocalPlayer.Character
        local targetChar = targetPlayer.Character
        
        if character and targetChar then
            local rootPart = character:FindFirstChild("HumanoidRootPart")
            local targetRoot = targetChar:FindFirstChild("HumanoidRootPart")
            
            if rootPart and targetRoot then
                rootPart.CFrame = targetRoot.CFrame * CFrame.new(0, 5, 5) -- Slightly behind
            end
        end
    end)
end

-- ===== PUBLIC METHODS =====

function GameExploits:Initialize()
    self.CurrentGame = DetectGame()
    print("[GameExploits] Detected game: " .. self.CurrentGame)
    
    if self.CurrentGame == "SniperDuels" then
        print("[GameExploits] Sniper Duels exploits loaded!")
        -- Initialize enhanced Sniper Duels features
        SniperDuels_EnhancedExploits()
    end
end

function GameExploits:SetItemDuping(value)
    self.SniperDuels.ItemDuping = value
    if value then
        SniperDuels_ItemDupe()
    end
end

function GameExploits:SetInfiniteMoney(value)
    self.SniperDuels.InfiniteMoney = value
    
    if self.Connections.InfiniteMoney then
        self.Connections.InfiniteMoney:Disconnect()
        self.Connections.InfiniteMoney = nil
    end
    
    if value then
        SniperDuels_InfiniteMoney()
    end
end

function GameExploits:SetInfiniteAmmo(value)
    self.SniperDuels.InfiniteAmmo = value
    
    if self.Connections.InfiniteAmmo then
        self.Connections.InfiniteAmmo:Disconnect()
        self.Connections.InfiniteAmmo = nil
    end
    
    if value then
        SniperDuels_InfiniteAmmo()
    end
end

function GameExploits:SetNoRecoil(value)
    self.SniperDuels.NoRecoil = value
    
    if self.Connections.NoRecoil then
        self.Connections.NoRecoil:Disconnect()
        self.Connections.NoRecoil = nil
    end
    
    if value then
        SniperDuels_NoRecoil()
    end
end

function GameExploits:SetRapidFire(value)
    self.SniperDuels.RapidFire = value
    
    if self.Connections.RapidFire then
        self.Connections.RapidFire:Disconnect()
        self.Connections.RapidFire = nil
    end
    
    if value then
        SniperDuels_RapidFire()
    end
end

function GameExploits:SetUnlockAllWeapons(value)
    self.SniperDuels.UnlockAllWeapons = value
    if value then
        SniperDuels_UnlockAllWeapons()
    end
end

function GameExploits:SetAutoFarm(value)
    self.SniperDuels.AutoFarm = value
    
    if self.Connections.AutoFarm then
        self.Connections.AutoFarm:Disconnect()
        self.Connections.AutoFarm = nil
    end
    
    if value then
        SniperDuels_AutoFarm()
    end
end

function GameExploits:TeleportTo(playerName)
    local targetPlayer = Players:FindFirstChild(playerName)
    if targetPlayer then
        SniperDuels_TeleportToPlayer(targetPlayer)
    end
end

-- Manual item dupe function (call from GUI)
function GameExploits:DupeItem(itemName, amount)
    if self.DupeItem then
        self.DupeItem(itemName, amount or 10)
    else
        warn("[Exploits] Item duping not initialized. Enable it first!")
    end
end

-- God Mode (Infinite Health)
function GameExploits:SetGodMode(value)
    self.SniperDuels.GodMode = value
    
    if self.Connections.GodMode then
        self.Connections.GodMode:Disconnect()
        self.Connections.GodMode = nil
    end
    
    if value then
        self.Connections.GodMode = RunService.Heartbeat:Connect(function()
            pcall(function()
                local character = LocalPlayer.Character
                if not character then return end
                
                local humanoid = character:FindFirstChildOfClass("Humanoid")
                if humanoid then
                    humanoid.Health = humanoid.MaxHealth
                end
            end)
        end)
    end
end

-- Instant Kill
function GameExploits:SetInstantKill(value)
    self.SniperDuels.InstantKill = value
    
    if value then
        print("[Exploits] Instant Kill enabled - damage multiplied")
    end
end

function GameExploits:Cleanup()
    for _, connection in pairs(self.Connections) do
        connection:Disconnect()
    end
    self.Connections = {}
end

-- Re-initialize if needed
function GameExploits:ReInitialize()
    self.Enabled = true
    self.CurrentGame = DetectGame()
    
    -- Start skin detection system
    self:StartSkinDetection()
    
    print("[GameExploits] Initialized for " .. (self.CurrentGame or "Unknown Game"))
end

-- Skin Detection System
function GameExploits:StartSkinDetection()
    local TextChatService = game:GetService("TextChatService")
    local Players = game:GetService("Players")
    local ReplicatedStorage = game:GetService("ReplicatedStorage")
    
    -- Store detected skins
    self.DetectedSkins = {}
    
    -- Common skin name patterns
    local skinPatterns = {
        "skin",
        "rare",
        "legendary",
        "mythic",
        "exotic",
        "divine",
        "godly",
        "unreal",
        "omega",
        "alpha",
        "beta",
        "gamma",
        "delta",
        "epsilon",
        "zeta",
        "eta",
        "theta",
        "iota",
        "kappa",
        "lambda",
        "mu",
        "nu",
        "xi",
        "omicron",
        "pi",
        "rho",
        "sigma",
        "tau",
        "upsilon",
        "phi",
        "chi",
        "psi",
        "omega"
    }
    
    -- Connect to chat messages
    local function connectToChat()
        -- Try TextChatService (new chat system)
        pcall(function()
            if TextChatService.ChatVersion == Enum.ChatVersion.TextChatService then
                TextChatService.MessageReceived:Connect(function(message)
                    self:ProcessChatMessage(message.Text, message.Author)
                end)
            end
        end)
        
        -- Try legacy chat system
        pcall(function()
            local chatEvents = ReplicatedStorage:FindFirstChild("DefaultChatSystemChatEvents")
            if chatEvents then
                local onMessageEvent = chatEvents:FindFirstChild("OnMessageDoneFiltering")
                if onMessageEvent then
                    onMessageEvent.OnClientEvent:Connect(function(messageObj)
                        self:ProcessChatMessage(messageObj.Message, messageObj.FromSpeaker)
                    end)
                end
            end
        end)
    end
    
    connectToChat()
    
    print("[GameExploits] Skin detection system started")
end

-- Process chat messages for skin detection
function GameExploits:ProcessChatMessage(message, author)
    -- Check if this is a system message about skins
    local lowerMessage = message:lower()
    
    -- Look for skin-related keywords
    for _, pattern in ipairs(skinPatterns) do
        if lowerMessage:find(pattern) then
            -- Extract potential skin name
            local skinName = self:ExtractSkinName(message)
            if skinName and #skinName > 3 then
                -- Check if we haven't already detected this skin
                if not self.DetectedSkins[skinName] then
                    self.DetectedSkins[skinName] = {
                        name = skinName,
                        author = author,
                        timestamp = tick()
                    }
                    
                    -- Notify user of detected skin
                    pcall(function()
                        game:GetService("StarterGui"):SetCore("SendNotification", {
                            Title = "Skin Detected";
                            Text = "Found skin: " .. skinName;
                            Duration = 5;
                            Icon = "rbxassetid://7733992358";
                        })
                    end)
                    
                    print("[SkinDetector] Detected potential skin: " .. skinName .. " from " .. author)
                end
            end
            break
        end
    end
end

-- Extract skin name from message
function GameExploits:ExtractSkinName(message)
    -- Remove common prefixes/suffixes
    local cleanMessage = message:gsub("received", ""):gsub("obtained", ""):gsub("found", "")
    cleanMessage = cleanMessage:gsub("!+$", ""):gsub("%s+", " ")
    
    -- Try to extract quoted skin names
    local quotedName = cleanMessage:match('"([^"]+)"')
    if quotedName and #quotedName > 3 then
        return quotedName
    end
    
    -- Try to extract skin names with common patterns
    local patterns = {
        "([A-Z][a-zA-Z]+%s*[A-Z][a-zA-Z]*)", -- CamelCase names
        "([A-Z][a-zA-Z]+%s*[a-z]+)",        -- Mixed case names
        "([a-zA-Z]+%s*[A-Z][a-zA-Z]*)"      -- Reverse mixed case
    }
    
    for _, pattern in ipairs(patterns) do
        local name = cleanMessage:match(pattern)
        if name and #name > 3 and #name < 30 then
            return name
        end
    end
    
    return nil
end

-- Dupe a detected skin
function GameExploits:DupeDetectedSkin(skinName)
    if self.DetectedSkins[skinName] then
        print("[GameExploits] Attempting to dupe detected skin: " .. skinName)
        self:DupeItem(skinName, 1)
    else
        warn("[GameExploits] Skin not found in detected list: " .. tostring(skinName))
    end
end

-- Get list of detected skins
function GameExploits:GetDetectedSkins()
    local skins = {}
    for name, data in pairs(self.DetectedSkins) do
        table.insert(skins, name)
    end
    return skins
end

-- Public function to open cases for free
function GameExploits:OpenCaseFree(caseType)
    if self.CurrentGame == "SniperDuels" then
        if self.OpenCaseFree then
            self.OpenCaseFree(caseType)
        end
    else
        warn("[GameExploits] Free case opening is only available for Sniper Duels")
    end
end

-- Public function to dupe skins
function GameExploits:DupeSkin(skinName)
    if self.CurrentGame == "SniperDuels" then
        if self.DupeSkin then
            self.DupeSkin(skinName)
        end
    else
        warn("[GameExploits] Skin duplication is only available for Sniper Duels")
    end
end

-- Public function to modify weapon stats
function GameExploits:ModifyWeaponStats(statType, value)
    if self.CurrentGame == "SniperDuels" then
        self:ModifyWeaponStats(statType, value)
    else
        warn("[GameExploits] Weapon stat modification is only available for Sniper Duels")
    end
end

-- Public function to enable/disable melee combo exploit
function GameExploits:SetMeleeCombo(enabled)
    if self.CurrentGame == "SniperDuels" then
        self.MeleeCombo(enabled)
    else
        warn("[GameExploits] Melee combo exploit is only available for Sniper Duels")
    end
end

function GameExploits:SetGodMode(value)
    self.Settings.GodMode = value
end

function GameExploits:SetAntiKnockback(value)
    self.Settings.AntiKnockback = value
end

function GameExploits:SetSpeedHack(value)
    self.Settings.SpeedHack = value
end

function GameExploits:SetSpeedMultiplier(value)
    self.Settings.SpeedMultiplier = value
end

function GameExploits:SetJumpBoost(value)
    self.Settings.JumpBoost = value
end

function GameExploits:SetJumpPower(value)
    self.Settings.JumpPower = value
end

return GameExploits
